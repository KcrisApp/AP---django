import{r as l,b as x,d as S,e,j as G,w as h,s as H,v as w,k as A,m as U,c as $,o as J,a as V,i as j,f as g,n as N,l as K,p as F,g as O,t as p,F as W,h as X}from"./index-aa10096d.js";import{_ as Y}from"./CardCheck-c68971b0.js";import{_ as Z}from"./Alert-b462ab6a.js";import{_ as ee}from"./Info-f9314415.js";/* empty css                                             */const te={class:"relative z-10","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},se=e("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-75 transition-opacity"},null,-1),oe={class:"fixed inset-0 z-10 w-screen overflow-y-auto"},ae={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},re={class:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg"},ne={class:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4"},ie={class:""},le={class:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left"},de=e("h2",{class:"text-base font-semibold leading-6 text-gray-900 mb-6",id:"modal-title"},[e("b",null,"Aggiungi spedizione ")],-1),ce=e("hr",{class:"mb-4"},null,-1),pe={class:"mt-2"},ue=["onSubmit"],me={class:"mb-6"},ge=e("label",{for:"react-checkbox-list",class:"w-full py-3 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300"},"Collaudo",-1),he={class:"mb-6"},_e=e("label",{for:"qta",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Quantità",-1),be={class:"mb-6"},fe=e("label",{for:"datetime",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Data",-1),ve={class:"mb-6"},xe=e("label",{for:"shipping_missing_components",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Componenti mancanti",-1),ye=e("hr",null,null,-1),ke={class:"mb-6 mt-4"},we=e("label",{for:"orderNumber",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Firma operatore",-1),$e=e("button",{type:"submit",class:"mt-3 inline-flex w-full justify-center mx-2 rounded-md px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-green-500 hover:text-white sm:mt-0 sm:w-auto"}," Save ",-1),Q={__name:"ShippingForm",props:{order:{type:String,required:!1},ship:{type:Object,required:!1}},emits:["close-modal","save-data"],setup(D,{emit:_}){const s=D;var f=new Date().getTimezoneOffset()*6e4;const y=new Date(Date.now()-f).toISOString().slice(0,16),u=l(0),b=l(y),m=l(!1),d=l(""),v=l("");if(s.ship){const c=new Date(s.ship.shipping_date).getTime()-f;console.log(c);const r=new Date(c).toISOString().slice(0,16);u.value=s.ship.shipping_qta,b.value=r,m.value=s.ship.shipping_check,d.value=s.ship.shipping_missing_components,v.value=s.ship.firma}async function C(){let c=U.shippingCRUD,r="POST";s.ship&&(c+=`${s.ship.uuid}/`,r="PUT");try{const n=await A({method:r,url:c,data:{shipping_qta:u.value,shipping_check:m.value,shipping_date:b.value,shipping_missing_components:d.value,firma:v.value,order:s.order}});_("save-data",n.data)}catch(n){_("save-data",n.response.status)}}function q(){_("close-modal")}return(c,r)=>(x(),S("div",te,[se,e("div",oe,[e("div",ae,[e("div",re,[e("div",ne,[e("div",ie,[e("div",le,[de,ce,e("div",pe,[e("form",{onSubmit:G(C,["prevent"])},[e("div",me,[h(e("input",{id:"react-checkbox-list",type:"checkbox","onUpdate:modelValue":r[0]||(r[0]=n=>m.value=n),class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500"},null,512),[[H,m.value]]),ge]),e("div",he,[_e,h(e("input",{type:"number",min:"0",max:"10000",step:"1",id:"qta",class:"text-center bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:"","onUpdate:modelValue":r[1]||(r[1]=n=>u.value=n)},null,512),[[w,u.value]])]),e("div",be,[fe,h(e("input",{type:"datetime-local",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full ps-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Select date","onUpdate:modelValue":r[2]||(r[2]=n=>b.value=n)},null,512),[[w,b.value]])]),e("div",ve,[xe,h(e("textarea",{"onUpdate:modelValue":r[3]||(r[3]=n=>d.value=n),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",name:"shipping_missing_components",id:"shipping_missing_components",cols:"30",rows:"3"},null,512),[[w,d.value]])]),ye,e("div",ke,[we,h(e("input",{type:"text",id:"orderNumber",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"",required:"","onUpdate:modelValue":r[4]||(r[4]=n=>v.value=n)},null,512),[[w,v.value]])]),e("div",{class:"px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6"},[$e,e("button",{type:"button",class:"mt-3 inline-flex w-full justify-center rounded-md px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-red-800 hover:text-white sm:mt-0 sm:w-auto",onClick:q}," Cancel ")])],40,ue)])])])])])])])]))}},Se={class:"p-4 w-full"},De={class:""},Ce=e("hr",{class:"my-4"},null,-1),qe={class:"flex justify-between my-4"},Me={class:"text-2xl mb-4 text-blue-900"},ze={class:"flex gap-2"},Te={class:"bg-blue-100 text-blue-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded dark:bg-blue-900 dark:text-blue-300"},je={class:"bg-red-100 text-red-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded dark:bg-red-900 dark:text-red-300"},Ae={class:"bg-green-100 text-green-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded dark:bg-green-900 dark:text-green-300"},Ue=e("hr",{class:"mt-2"},null,-1),Ve={class:"text-left text-sm font-light flex-wrap w-full"},Ne=e("thead",{class:"border-b font-medium dark:border-neutral-500"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-4"},"Ordine"),e("th",{scope:"col",class:"px-6 py-4"},"Collaudo"),e("th",{scope:"col",class:"px-6 py-4"},"Qtà"),e("th",{scope:"col",class:"px-2 py-4"},"Data"),e("th",{scope:"col",class:"py-4"},"Componenti mancanti"),e("th",{scope:"col",class:"py-4"},"Firma operatore"),e("th",{scope:"col",class:"py-4"})])],-1),Fe={class:"whitespace-nowrap px-6 py-4 font-medium"},Oe={class:"whitespace-nowrap px-6 py-4"},Qe={class:"whitespace-nowrap px-6 py-4"},Be={class:"whitespace-nowrap py-4"},Ee={class:"whitespace-nowrap px-6 py-4"},Re={class:"whitespace-nowrap py-4"},Ie={class:"py-4"},Le=["onClick"],Pe={class:"py-4"},Xe={__name:"ShippingDetails",props:{order_id:String},setup(D){const _=D,s=l([]),f=l(!1);l("");const y=l(!1),u=l(!1),b=l({}),m=l(!1),d=l(""),v=$(()=>{let t=0;return s.value.forEach((o,a)=>{a==0&&(t=o.order_quantity)}),t}),C=$(()=>{let t=0,o=0,a=0;return s.value.forEach((k,i)=>{o+=k.shipping_qta,i==0&&(t=k.order_quantity)}),a=t-o,a}),q=$(()=>{let t=0;return s.value.forEach((o,a)=>{t+=o.shipping_qta}),t}),c=$(()=>{let t=0;return s.value.forEach((o,a)=>{a==0&&(t=o.order_number)}),t}),r=t=>new Date(t).toLocaleString(),n=t=>{const o=s.value.findIndex(a=>a.id==t.id);s.value[o].shipping_qta=t.shipping_qta,s.value[o].shipping_check=t.shipping_check,s.value[o].shipping_date=t.shipping_date,z()};function B(t){M(),typeof t=="number"?(d.value="Aggiornametno non riuscito",m.value=!1):(s.value.unshift(t),d.value="Aggiornametno avvenuto con successo",m.value=!0),setTimeout(()=>d.value="",5e3)}const E=t=>{s.value=s.value.filter(o=>o.uuid!==t)},M=()=>{f.value=!f.value},z=()=>{u.value=!u.value},R=t=>{z(),b.value=t},T=()=>{y.value=!y.value};async function I(){let t=`${U.shippingCRUD}?order=${_.order_id}`;try{const o=await A.get(t);s.value.push(...o.data)}catch(o){alert(o)}}async function L(t){let o=`${U.shippingCRUD}${t}/`;try{const a=await A.delete(o);T(),console.log(a),E(t)}catch(a){alert(a)}}return J(()=>{I()}),(t,o)=>{const a=V("font-awesome-icon"),k=V("router-link");return x(),S("main",null,[h(g(ee,{message:d.value,"icon-type":m.value},null,8,["message","icon-type"]),[[j,d.value]]),e("div",Se,[e("div",De,[c.value?(x(),N(k,{key:0,to:{name:"order-details",params:{order_number:c.value}},class:"hover:text-green-600"},{default:K(()=>[g(a,{icon:"arrow-left-long"}),O(" Back to "+p(c.value),1)]),_:1},8,["to"])):F("",!0),Ce]),e("div",qe,[e("div",null,[e("h1",Me,[g(a,{icon:"truck-fast"}),O(" Dettaglio Spedizioni ")])]),e("div",{class:"flex gap-2"},[e("button",{class:"hover:bg-amber-400 max-h-8 text-sm text-blue-950 font-semibold hover:text-white py-1 px-4 border hover:border-none border-blue-950 rounded",onClick:M}," Add ")])]),e("div",ze,[e("span",Te,"Quantità totale: "+p(v.value)+" pz",1),e("span",je,"Da spedire: "+p(C.value)+" pz",1),e("span",Ae,"Spedite: "+p(q.value)+" pz",1)]),Ue,e("table",Ve,[Ne,e("tbody",null,[(x(!0),S(W,null,X(s.value,i=>(x(),S("tr",{class:"border-b dark:border-neutral-500",key:i.uuid,ref_for:!0,ref:"modalRef"},[e("td",Fe,p(i.order_number),1),e("td",Oe,[g(Y,{status:i.shipping_check,text:""},null,8,["status"])]),e("td",Qe,p(i.shipping_qta),1),e("td",Be,p(r(i.shipping_date)),1),e("td",Ee,p(i.shipping_missing_components?i.shipping_missing_components:"Nessuno"),1),e("td",Re,p(i.firma),1),e("td",Ie,[e("div",{class:"flex justify-center gap-4",onClick:P=>R(i)},[g(a,{icon:"pen-to-square",class:"text-blue-950 hover:text-green-500"})],8,Le)]),e("td",Pe,[e("div",{class:"flex justify-center gap-4",onClick:T},[g(a,{icon:"trash",class:"text-red-900 hover:text-red-500"})]),h(g(Z,{"icon-type":"error",title:"Attenzione",message:`Sei sicuro di voler eliminare la spedizione per l'ordine ${i.order_number} del ${i.shipping_date}?`,onCloseAlert:T,onConfirm:P=>L(i.uuid)},null,8,["message","onConfirm"]),[[j,y.value]])])]))),128))])])]),h(g(Q,{onCloseModal:M,onSaveData:B,order:_.order_id},null,8,["order"]),[[j,f.value]]),u.value?(x(),N(Q,{key:0,onCloseModal:z,ship:b.value,order:_.order_id,onSaveData:n},null,8,["ship","order"])):F("",!0)])}}};export{Xe as default};
