import{r as l,b as v,d as w,e,j as E,w as g,s as I,v as k,k as q,m as M,c as j,o as L,a as z,x as U,l as P,q as V,f as m,g as N,t as h,F as G,h as H,i as T}from"./index-7ae892e9.js";import{_ as J}from"./CardCheck-71bf1f25.js";import{_ as K}from"./Alert-61058271.js";const W={class:"relative z-10","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},X=e("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-75 transition-opacity"},null,-1),Y={class:"fixed inset-0 z-10 w-screen overflow-y-auto"},Z={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},ee={class:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg"},te={class:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4"},se={class:""},oe={class:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left"},ae=e("h2",{class:"text-base font-semibold leading-6 text-gray-900 mb-6",id:"modal-title"},[e("b",null,"Aggiungi spedizione ")],-1),re=e("hr",{class:"mb-4"},null,-1),ne={class:"mt-2"},ie=["onSubmit"],le={class:"mb-6"},de=e("label",{for:"react-checkbox-list",class:"w-full py-3 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300"},"Collaudo",-1),ce={class:"mb-6"},pe=e("label",{for:"qta",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Quantità",-1),ue={class:"mb-6"},me=e("label",{for:"datetime",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Data",-1),he={class:"mb-6"},ge=e("label",{for:"shipping_missing_components",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Componenti mancanti",-1),_e=e("hr",null,null,-1),be={class:"mb-6 mt-4"},fe=e("label",{for:"orderNumber",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Firma operatore",-1),xe=e("button",{type:"submit",class:"mt-3 inline-flex w-full justify-center mx-2 rounded-md px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-green-500 hover:text-white sm:mt-0 sm:w-auto"}," Save ",-1),A={__name:"ShippingForm",props:{order:{type:String,required:!1},ship:{type:Object,required:!1}},emits:["close-modal","save-data"],setup($,{emit:_}){const s=$;var b=new Date().getTimezoneOffset()*6e4;const y=new Date(Date.now()-b).toISOString().slice(0,16),d=l(0),u=l(y),f=l(!1),c=l(""),x=l("");if(s.ship){const p=new Date(s.ship.shipping_date).getTime()-b;console.log(p);const o=new Date(p).toISOString().slice(0,16);d.value=s.ship.shipping_qta,u.value=o,f.value=s.ship.shipping_check,c.value=s.ship.shipping_missing_components,x.value=s.ship.firma}async function S(){let p=M.shippingCRUD,o="POST";s.ship&&(p+=`${s.ship.uuid}/`,o="PUT");try{const a=await q({method:o,url:p,data:{shipping_qta:d.value,shipping_check:f.value,shipping_date:u.value,shipping_missing_components:c.value,firma:x.value,order:s.order}});_("save-data",a.data)}catch(a){a=a,alert(a)}}function C(){_("close-modal")}return(p,o)=>(v(),w("div",W,[X,e("div",Y,[e("div",Z,[e("div",ee,[e("div",te,[e("div",se,[e("div",oe,[ae,re,e("div",ne,[e("form",{onSubmit:E(S,["prevent"])},[e("div",le,[g(e("input",{id:"react-checkbox-list",type:"checkbox","onUpdate:modelValue":o[0]||(o[0]=a=>f.value=a),class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500"},null,512),[[I,f.value]]),de]),e("div",ce,[pe,g(e("input",{type:"number",min:"0",max:"10000",step:"1",id:"qta",class:"text-center bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:"","onUpdate:modelValue":o[1]||(o[1]=a=>d.value=a)},null,512),[[k,d.value]])]),e("div",ue,[me,g(e("input",{type:"datetime-local",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full ps-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Select date","onUpdate:modelValue":o[2]||(o[2]=a=>u.value=a)},null,512),[[k,u.value]])]),e("div",he,[ge,g(e("textarea",{"onUpdate:modelValue":o[3]||(o[3]=a=>c.value=a),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",name:"shipping_missing_components",id:"shipping_missing_components",cols:"30",rows:"3"},null,512),[[k,c.value]])]),_e,e("div",be,[fe,g(e("input",{type:"text",id:"orderNumber",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"",required:"","onUpdate:modelValue":o[4]||(o[4]=a=>x.value=a)},null,512),[[k,x.value]])]),e("div",{class:"px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6"},[xe,e("button",{type:"button",class:"mt-3 inline-flex w-full justify-center rounded-md px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-red-800 hover:text-white sm:mt-0 sm:w-auto",onClick:C}," Cancel ")])],40,ie)])])])])])])])]))}},ve={class:"p-4 w-full"},ye={class:""},ke=e("hr",{class:"my-4"},null,-1),we={class:"flex justify-between my-4"},$e={class:"text-2xl mb-4 text-blue-900"},Se={class:""},Ce=e("hr",{class:"mt-2"},null,-1),De={class:"text-left text-sm font-light flex-wrap w-full"},qe=e("thead",{class:"border-b font-medium dark:border-neutral-500"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-4"},"Ordine"),e("th",{scope:"col",class:"px-6 py-4"},"Collaudo"),e("th",{scope:"col",class:"px-6 py-4"},"Qtà"),e("th",{scope:"col",class:"px-2 py-4"},"Data"),e("th",{scope:"col",class:"py-4"},"Componenti mancanti"),e("th",{scope:"col",class:"py-4"},"Firma operatore"),e("th",{scope:"col",class:"py-4"})])],-1),Me={class:"whitespace-nowrap px-6 py-4 font-medium"},je={class:"whitespace-nowrap px-6 py-4"},ze={class:"whitespace-nowrap px-6 py-4"},Ue={class:"whitespace-nowrap py-4"},Ve={class:"whitespace-nowrap px-6 py-4"},Ne={class:"whitespace-nowrap py-4"},Te={class:"py-4"},Ae=["onClick"],Fe={class:"py-4"},Re={__name:"ShippingDetails",props:{order_id:String},setup($){const _=$,s=l([]),b=l(!1);l("");const y=l(!1),d=l(!1),u=l({}),f=j(()=>{let t=0;return s.value.forEach((r,n)=>{n==0&&(t=r.order_quantity)}),t}),c=j(()=>{let t=0;return s.value.forEach((r,n)=>{n==0&&(t=r.order_number)}),t}),x=t=>new Date(t).toLocaleString(),S=t=>{const r=s.value.findIndex(n=>n.id==t.id);s.value[r].shipping_qta=t.shipping_qta,s.value[r].shipping_check=t.shipping_check,s.value[r].shipping_date=t.shipping_date,a()};function C(t){o(),s.value.unshift(t)}const p=t=>{s.value=s.value.filter(r=>r.uuid!==t)},o=()=>{b.value=!b.value},a=()=>{d.value=!d.value},F=t=>{a(),u.value=t},D=()=>{y.value=!y.value};async function O(){let t=`${M.shippingCRUD}?order=${_.order_id}`;try{const r=await q.get(t);s.value.push(...r.data)}catch(r){alert(r)}}async function B(t){let r=`${M.shippingCRUD}${t}/`;try{const n=await q.delete(r);D(),console.log(n),p(t)}catch(n){alert(n)}}return L(()=>{O()}),(t,r)=>{const n=z("font-awesome-icon"),Q=z("router-link");return v(),w("main",null,[e("div",ve,[e("div",ye,[c.value?(v(),U(Q,{key:0,to:{name:"order-details",params:{order_number:c.value}},class:"hover:text-green-600"},{default:P(()=>[m(n,{icon:"arrow-left-long"}),N(" Back to "+h(c.value),1)]),_:1},8,["to"])):V("",!0),ke]),e("div",we,[e("div",null,[e("h1",$e,[m(n,{icon:"truck-fast"}),N(" Dettaglio Spedizioni ")])]),e("div",{class:"flex gap-2"},[e("button",{class:"hover:bg-amber-400 max-h-8 text-sm text-blue-950 font-semibold hover:text-white py-1 px-4 border hover:border-none border-blue-950 rounded",onClick:o}," Add ")])]),e("p",Se,"Quantità totale: "+h(f.value)+"pz",1),Ce,e("table",De,[qe,e("tbody",null,[(v(!0),w(G,null,H(s.value,i=>(v(),w("tr",{class:"border-b dark:border-neutral-500",key:i.uuid,ref_for:!0,ref:"modalRef"},[e("td",Me,h(i.order_number),1),e("td",je,[m(J,{status:i.shipping_check,text:""},null,8,["status"])]),e("td",ze,h(i.shipping_qta),1),e("td",Ue,h(x(i.shipping_date)),1),e("td",Ve,h(i.shipping_missing_components?i.shipping_missing_components:"Nessuno"),1),e("td",Ne,h(i.firma),1),e("td",Te,[e("div",{class:"flex justify-center gap-4",onClick:R=>F(i)},[m(n,{icon:"pen-to-square",class:"text-blue-950 hover:text-green-500"})],8,Ae)]),e("td",Fe,[e("div",{class:"flex justify-center gap-4",onClick:D},[m(n,{icon:"trash",class:"text-red-900 hover:text-red-500"})]),g(m(K,{"icon-type":"error",title:"Attenzione",message:`Sei sicuro di voler eliminare la spedizione per l'ordine ${i.order_number} del ${i.shipping_date}?`,onCloseAlert:D,onConfirm:R=>B(i.uuid)},null,8,["message","onConfirm"]),[[T,y.value]])])]))),128))])])]),g(m(A,{onCloseModal:o,onSaveData:C,order:_.order_id},null,8,["order"]),[[T,b.value]]),d.value?(v(),U(A,{key:0,onCloseModal:a,ship:u.value,order:_.order_id,onSaveData:S},null,8,["ship","order"])):V("",!0)])}}};export{Re as default};
