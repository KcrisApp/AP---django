import{r as a,b as p,d as v,e,w as $,v as j,y as ne,m as D,k as C,n as de,a as O,t as b,i as N,f,z as ie,p as ce,A as ue,B as pe,c as B,o as me,F as z,h as R,g as S,u as I,q as M,l as _e,C as be,x as E}from"./index-7ae892e9.js";import{_ as ve}from"./Alert-61058271.js";import{_ as fe}from"./OrderForm-437cefab.js";import{_ as he}from"./BoardForm-6085c4c7.js";const ge={class:"relative z-10","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},xe=e("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-75 transition-opacity"},null,-1),ye={class:"fixed inset-0 z-10 w-screen overflow-y-auto"},we={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},ke={class:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-xl"},$e={class:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4"},Se={class:""},Ce={class:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left"},De={class:"flex justify-between my-4"},Me=e("h2",{class:"text-base font-semibold leading-6 p-2 text-gray-900",id:"modal-title"},[e("b",{class:"text-blue-900"},"Aggiungi step")],-1),Ne={class:"flex items-center"},je=e("label",{for:"color",class:"block mr-2 text-md font-medium dark:text-white"},"Step color:",-1),Ae=e("hr",{class:"my-5"},null,-1),Fe={class:"mt-4"},Ue={class:"mb-6"},Ve=e("label",{for:"orderNumber",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Step name",-1),qe={class:"mb-6"},Be=e("label",{for:"orderNumber",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Ordine del processo",-1),ze={class:"mb-6"},Re=e("label",{for:"procesNote",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Descrizione del processo",-1),Ie={class:"mb-6"},Oe=e("label",{for:"procesNote",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Zona del process",-1),Pe=de('<option selected value="Verifica">Verifica</option><option value="Smt">Smt</option><option value="Collaudo">Collaudo</option><option value="Saldatura Onda">Saldatura Onda</option><option value="Saldatura selettiva">Saldatura selettiva</option><option value="Preformatura">Preformatura</option>',6),Te=[Pe],L={__name:"StepForm",props:{steps:{type:Object,required:!1},board:{type:Number,required:!0}},emits:["close-modal","save-data"],setup(g,{emit:x}){const o=g,r=a("#B41F1F"),i=a(1),l=a(""),y=a(""),w=a("Verifica");o.steps&&(console.log(o.steps),w.value=o.steps.step_type,y.value=o.steps.step_name,l.value=o.steps.step_description,r.value=o.steps.step_color,i.value=o.steps.step_order);async function m(){try{let s="POST",d=D.productionstepCRUD;o.steps&&(d=D.productionstepCRUD+`${o.steps.uuid}/`,s="PATCH");const c=await C({method:s,url:d,data:{step_type:w.value,step_name:y.value,step_description:l.value,step_color:r.value,step_order:i.value,board:o.board}});x("save-data",c.data)}catch(s){s=s,alert(s)}}function h(){x("close-modal")}return(s,d)=>(p(),v("div",ge,[xe,e("div",ye,[e("div",we,[e("div",ke,[e("div",$e,[e("div",Se,[e("div",Ce,[e("div",De,[Me,e("div",Ne,[je,$(e("input",{id:"color",type:"color","onUpdate:modelValue":d[0]||(d[0]=c=>r.value=c),class:""},null,512),[[j,r.value]])])]),Ae,e("div",Fe,[e("div",null,[e("div",Ue,[Ve,$(e("input",{type:"text",id:"orderNumber",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"",required:"","onUpdate:modelValue":d[1]||(d[1]=c=>y.value=c)},null,512),[[j,y.value]])]),e("div",qe,[Be,$(e("input",{type:"number",id:"orderNumber",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"",required:"","onUpdate:modelValue":d[2]||(d[2]=c=>i.value=c)},null,512),[[j,i.value]])]),e("div",ze,[Re,$(e("textarea",{"onUpdate:modelValue":d[3]||(d[3]=c=>l.value=c),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",name:"procesNote",id:"procesNote",cols:"30",rows:"3"},null,512),[[j,l.value]])]),e("div",Ie,[Oe,$(e("select",{"onUpdate:modelValue":d[4]||(d[4]=c=>w.value=c),id:"countries",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},Te,512),[[ne,w.value]])]),e("div",{class:"px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6"},[e("button",{onClick:m,class:"mt-3 inline-flex w-full justify-center mx-2 rounded-md px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-green-500 hover:text-white sm:mt-0 sm:w-auto"}," Save "),e("button",{class:"mt-3 inline-flex w-full justify-center rounded-md px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-red-800 hover:text-white sm:mt-0 sm:w-auto",onClick:h}," Cancel ")])])])])])])])])])]))}},Ee={class:"relative z-10","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},Le=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1),He={class:"fixed inset-0 z-10 w-screen overflow-y-auto"},Qe={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},Ze={class:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg"},Ge={class:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4 text-center"},Je={class:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left"},Ke=e("h2",{class:"font-semibold text-xl leading-6 text-gray-900",id:"modal-title"},"Immagine scheda",-1),We={class:"mt-2"},Xe=["src"],Ye={__name:"ModalImg",props:{board_id:{type:Number,required:!0}},emits:["close-alert","save-img"],setup(g,{emit:x}){const o=g,r=a(null),i=a(null);function l(){x("close-alert")}function y(m){i.value=m.target.files[0];const h=new FileReader;h.readAsDataURL(i.value),h.onload=s=>{r.value=s.target.result,console.log(r.value)}}async function w(){var m=new FormData;m.append("board_img",i.value);let h=D.updateImgBoard+`${o.board_id}`;console.log(h);try{const s=await C({method:"put",url:h,data:m,headers:{"content-type":`multipart/form-data; boundary=${m._boundary}`}});console.log(s),x("save-img",s.data)}catch(s){alert(s)}}return(m,h)=>(p(),v("form",null,[e("div",Ee,[Le,e("div",He,[e("div",Qe,[e("div",Ze,[e("div",Ge,[e("div",Je,[Ke,e("div",We,[e("div",null,[e("img",{src:r.value,class:"uploading-image"},null,8,Xe),e("input",{type:"file",accept:"image/jpeg",onChange:y},null,32)])])])]),e("div",{class:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6 gap-2"},[e("button",{type:"button",class:"mt-3 inline-flex w-full justify-center rounded-md bg-green-500 px-3 py-2 text-sm font-semibold text-white shadow-sm ring-1 ring-inset hover:bg-red-900 sm:mt-0 sm:w-auto",onClick:w},"Save"),e("button",{type:"button",class:"mt-3 inline-flex w-full justify-center rounded-md px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset hover:bg-gray-200 sm:mt-0 sm:w-auto",onClick:l},"Cancel")])])])])])]))}},et={class:"p-2 max-w-sm"},tt={class:"border border-slate-100 flex rounded-lg h-full bg-slate-50 dark:bg-gray-800 flex-col"},ot={class:"py-2 rounded-md bg-blue-950 text-white"},st={class:"px-2 text-md font-medium"},rt={class:"p-2"},lt={class:"flex flex-col justify-between flex-grow"},at={class:"leading-relaxed text-base dark:text-gray-300"},nt={class:"flex mt-2 justify-end gap-4"},dt={class:"flex flex-col justify-between flex-grow mt-4"},it={__name:"StepCard",props:{color:{type:String,required:!0},title:{type:String,required:!0},content:{type:String,required:!0},order:{type:Number,required:!0},rep:{type:String,required:!0}},emits:["mod-step","delete-step"],setup(g,{emit:x}){const o=a(!1),r=()=>{o.value=!o.value},i=()=>{x("delete-step")},l=()=>{x("mod-step")};return(y,w)=>{const m=O("font-awesome-icon");return p(),v("div",et,[e("div",tt,[e("div",ot,[e("h5",st,b(g.order)+" - "+b(g.title),1)]),e("div",rt,[e("div",lt,[e("p",at,b(g.content),1)]),e("div",{class:"p-2",onMouseenter:r,onMouseleave:r},[$(e("div",nt,[f(m,{icon:"pen-to-square",class:"text-blue-950 hover:text-green-500",onClick:l}),f(m,{icon:"trash",class:"text-red-900 hover:text-red-500",onClick:i})],512),[[N,o.value]])],32),e("div",dt,[e("span",{style:ie({"background-color":g.color}),class:"text-black text-xs font-medium me-2 px-2.5 py-0.5 rounded dark:bg-blue-900 dark:text-blue-300"},b(g.rep),5)])])])])}}},ct={class:"p-4 w-full"},ut={class:"flex justify-between my-4"},pt={class:"text-2xl"},mt={key:0,class:"flex gap-2"},_t=e("hr",{class:"my-2"},null,-1),bt={class:"flex bg-slate-50 p-4 gap-4 rounded-xl"},vt={class:"col"},ft=["src"],ht={class:"col"},gt={class:"mt-2"},xt={class:"mt-2"},yt={class:"flex justify-between mt-4"},wt=e("h4",{class:"text-2xl"},"Ordini",-1),kt={class:"bg-s-100 text-blue-800 text-sm font-medium mr-2 px-2.5 py-0.5 rounded dark:bg-slate-300 dark:text-blue-300"},$t=e("hr",{class:"my-2"},null,-1),St={class:"text-left text-sm font-light flex-wrap w-full"},Ct=e("thead",{class:"border-b font-medium dark:border-neutral-500"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-4"},"Numero ordine"),e("th",{scope:"col",class:"px-6 py-4"},"Quantit√†"),e("th",{scope:"col",class:"px-6 py-4"},"Data creazione"),e("th",{scope:"col",class:"px-6 py-4"},"Scheda"),e("th",{scope:"col",class:"px-6 py-4"})])],-1),Dt={class:"whitespace-nowrap px-6 py-2 font-medium"},Mt={class:"whitespace-nowrap px-6 py-2"},Nt={class:"whitespace-nowrap px-6 py-2"},jt={class:"whitespace-nowrap px-6 py-2"},At={class:"whitespace-nowrap px-6 py-2"},Ft=e("hr",{class:"my-5"},null,-1),Ut={class:"flex justify-center mt-5"},Vt={key:0,class:"text-center"},qt={key:1},Bt=e("hr",{class:"my-5"},null,-1),zt={class:"flex justify-between my-4"},Rt=e("h4",{class:"text-2xl ml-5"},"Fasi produttive",-1),It={class:"flex gap-2"},Ot={class:"flex flex-wrap justify-center mt-10"},Ht={__name:"BoardDetails",props:{uuid:String},setup(g){const x=g,o=ce();console.log(o.first_name);const r=a([]),i=a([]),l=a([]),y=a(!1),w=a(!1),m=a(!1),h=a(!1),s=a(!1),d=a(!1),c=a(!1),P=a({}),H=ue();pe();const Q=B(()=>i.value.length),T=B(()=>r.value[0].id),Z=B(()=>l.value.sort((t,n)=>t.step_order-n.step_order)),G=t=>{P.value=t,c.value=!0},J=t=>{const n=l.value.findIndex(u=>u.uuid==t.uuid);console.log(t),l.value[n].step_type=t.step_type,l.value[n].step_name=t.step_name,l.value[n].step_description=t.step_description,l.value[n].step_color=t.step_color,l.value[n].step_order=t.step_order,c.value=!1};async function K(){try{C.all([C.get(`${D.boardsCRUD}${x.uuid}/`),C.get(`${D.productionstepCRUD}?board=${x.uuid}`)]).then(C.spread((t,n)=>{r.value.push(t.data),i.value=t.data.order,n.data.forEach(u=>{l.value.push(u)})}))}catch(t){alert(t)}}async function W(t){let n=`${D.boardsCRUD}${t}/`;try{const u=await C.delete(n);A(),H.push({name:"boards"})}catch(u){alert(u)}}async function X(t){let n=`${D.productionstepCRUD}${t}/`;try{const u=await C.delete(n);console.log(u),ee(t)}catch(u){alert(u)}}const Y=t=>{V(),l.value.unshift(t)},ee=t=>{l.value=l.value.filter(n=>n.uuid!==t)};function te(t){F(),i.value.unshift(t)}function oe(t){U(),console.log(t),r.value[0].board_code=t.board_code,r.value[0].board_name=t.board_name,r.value[0].board_rev=t.board_rev,r.value[0].customer=t.customer}function se(t){q(),r.value[0].board_img=t.board_img}function A(){y.value=!y.value}function F(){w.value=!w.value}function U(){m.value=!m.value}function re(){s.value=!s.value}function V(){d.value=!d.value}function q(){h.value=!h.value}return me(()=>{K()}),(t,n)=>{const u=O("font-awesome-icon"),le=O("router-link");return p(),v("main",null,[(p(!0),v(z,null,R(r.value,k=>(p(),v("div",ct,[$(f(ve,{"icon-type":"error",title:"Attenzione",message:"Sei sicuro di voler eliminare la scheda?",onCloseAlert:A,onConfirm:_=>W(k.uuid)},null,8,["onConfirm"]),[[N,y.value]]),$(f(he,{onCloseModal:U,onSaveData:oe,boardArr:k},null,8,["boardArr"]),[[N,m.value]]),$(f(fe,{board_id:k.id,onCloseModal:F,onSaveData:te},null,8,["board_id"]),[[N,w.value]]),$(f(Ye,{onCloseAlert:q,board_id:k.id,onSaveImg:se},null,8,["board_id"]),[[N,h.value]]),e("div",ut,[e("h1",pt,[f(u,{icon:"hard-drive",class:"text-blue-950"}),S(" Scheda: "+b(k.board_name),1)]),I(o).company_role=="M"?(p(),v("div",mt,[e("button",{class:"hover:bg-blue-500 hover:border-blue-500 text-blue-950 font-semibold hover:text-white py-1 px-4 border border-blue-950 rounded",onClick:F},[f(u,{icon:"folder-plus"}),S(" Aggiungi ordine ")]),e("button",{class:"hover:bg-amber-400 hover:border-amber-400 text-blue-950 font-semibold hover:text-white py-1 px-4 border border-blue-950 rounded",onClick:U},[f(u,{icon:"folder-plus"}),S(" Modifica ")]),e("button",{class:"hover:bg-red-900 bg-red-600 text-white font-semibold py-1 px-4 rounded",onClick:A}," Elimina ")])):M("",!0)]),_t,e("div",bt,[e("div",vt,[e("img",{class:"h-auto max-w-xs",src:k.board_img},null,8,ft),I(o).company_role=="M"?(p(),v("button",{key:0,class:"hover:bg-slate-500 hover:border-slate-500 text-blue-950 font-semibold hover:text-white py-1 px-4 border border-blue-950 rounded mt-4",onClick:q},"Carica/Modifica")):M("",!0)]),e("div",ht,[e("p",null,[S(" Codice: "),e("b",null,b(k.board_code),1)]),e("p",gt,[S(" Revisione: "),e("b",null,b(k.board_rev),1)]),e("p",null,[S(" Data di creazione: "),e("b",null,b(k.created_at),1)]),e("p",xt,[S(" Cliente: "),e("b",null,b(k.customer),1)])])]),e("div",yt,[wt,e("p",kt,"Numero ordini: "+b(Q.value),1)]),$t,e("table",St,[Ct,e("tbody",null,[(p(!0),v(z,null,R(i.value,_=>(p(),v("tr",{class:"border-b dark:border-neutral-500",key:i.value.uuid},[e("td",Dt,b(_.order_number),1),e("td",Mt,b(_.order_quantity),1),e("td",Nt,b(_.created_at),1),e("td",jt,b(k.board_name),1),e("td",At,[f(le,{to:{name:"order-details",params:{order_number:_.order_number}},class:"hover:text-green-600"},{default:_e(()=>[f(u,{icon:"fa-eye",class:"text-blue-950 hover:text-green-500"})]),_:2},1032,["to"])])]))),128))])]),Ft,e("div",Ut,[e("button",{class:be(["hover:border-blue-500 text-blue-950 font-semibold hover:text-white py-1 px-4 rounded",s.value?"hover:bg-red-500":"bg-blue-500 text-white hover:bg-blue-900"]),onClick:re},b(s.value?"Nascondi fasi produttive":"Mostra fasi produttive"),3)]),s.value?M("",!0):(p(),v("p",Vt,"...")),s.value?(p(),v("div",qt,[Bt,e("div",zt,[Rt,e("div",It,[I(o).company_role=="M"?(p(),v("button",{key:0,class:"hover:bg-blue-500 hover:border-blue-500 text-blue-950 font-semibold hover:text-white py-1 px-4 border border-blue-950 rounded",onClick:V},[f(u,{icon:"folder-plus"}),S(" Aggiungi fase ")])):M("",!0)])]),e("div",Ot,[(p(!0),v(z,null,R(Z.value,_=>(p(),E(it,{color:_.step_color,title:_.step_name,content:_.step_description,order:_.step_order,rep:_.step_type,key:_.uuid,onDeleteStep:ae=>X(_.uuid),onModStep:ae=>G(_)},null,8,["color","title","content","order","rep","onDeleteStep","onModStep"]))),128))]),$(f(L,{board:T.value,onCloseModal:V,onSaveData:Y},null,8,["board"]),[[N,d.value]]),c.value?(p(),E(L,{key:0,steps:P.value,board:T.value,onCloseModal:n[0]||(n[0]=_=>c.value=!1),onSaveData:J},null,8,["steps","board"])):M("",!0)])):M("",!0)]))),256))])}}};export{Ht as default};
